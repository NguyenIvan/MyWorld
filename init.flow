#!/bin/bash

echo Starting emulator and wallet-dev services
docker-compose -f /code/wallet/docker-compose.yml  up -d
sleep 2
echo Deploying flow project with default addresses to emulator chain
flow project deploy --network=emulator
sleep 2
echo Create FUSD Minter for service account
flow transactions send cadence/transactions/CreateFUSDMinter.cdc
SELLER_ADDRESS=0x179b6b1cb6755e31
echo Seller Address: $SELLER_ADDRESS
echo Create FUSD Vault for Seller Account
flow transactions send cadence/transactions/CreateFUSDVault.cdc --signer Seller
echo Service Account:
flow accounts get f8d6e0586b0a20c7 |grep Contract
echo Seller Account:
flow accounts get $SELLER_ADDRESS |grep Contract
sleep 2
echo "Send 10,000 FUSD for Seller ($SELLER_ADDRESS)"
flow transactions send cadence/transactions/MintFUSD.cdc  $SELLER_ADDRESS  10000.00

# flow config add account --address $SELLER_ADDRESS --name Seller --private-key $SELLER_PRIVATE_KEY
# flow emulator --token-supply 1000000000.0 & 1>flow.log 2>&1
# sleep 2
# SELLER_PUBLIC_KEY=d784c4e647245c34eadf8a89b822400436c317ae3cdfb0e75e5d0d3b9442bae07e679b638c4a55df216b870c607c907278e5b18d9f5edf51f8524c3186c6d068
# SELLER_PRIVATE_KEY=649b0a182c02a2b067140a99ae766cf7add2ccdaa8e3351a782635f7d2b8d832
# SELLER_ADDRESS=$(flow accounts create --key $SELLER_PUBLIC_KEY |awk '/Address/ {print $2}')